<?php

/**
 * @file
 * Contains shc_migrate_change_club.module.
 */

use Drupal\Core\Routing\RouteMatchInterface;

/**
 * Implements hook_help().
 */
function shc_migrate_change_club_help($route_name, RouteMatchInterface $route_match) {
  switch ($route_name) {
    // Main module help for the shc_migrate_change_club module.
    case 'help.page.shc_migrate_change_club':
      $output = '';
      $output .= '<h3>' . t('About') . '</h3>';
      $output .= '<p>' . t('Migrates survey responses from Qualtrics to create/update users and nodes of type change_club') . '</p>';
      return $output;

    default:
  }
}

function shc_migrate_change_club_post_qualtricssession(){

$curl = curl_init();

curl_setopt_array($curl, array(
  CURLOPT_URL => "https://ca1.qualtrics.com/API/v3/surveys/SV_doN3AIQ0sPGWuVv/export-responses",
  CURLOPT_RETURNTRANSFER => true,
  CURLOPT_ENCODING => "",
  CURLOPT_MAXREDIRS => 10,
  CURLOPT_TIMEOUT => 0,
  CURLOPT_FOLLOWLOCATION => true,
  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
  CURLOPT_CUSTOMREQUEST => "POST",
  CURLOPT_POSTFIELDS =>"{\n\t\"format\": \"json\"\n}",
  CURLOPT_HTTPHEADER => array(
    "X-API-TOKEN: uox0HEkJTPaXBue4R8R4BBQTjn4PmuUIcACDjbJV",
    "Content-Type: application/json"
  ),
));

$response = curl_exec($curl);

curl_close($curl);
echo $response;


}

function shc_migrate_change_club_get_qualtricsfileid(){

$curl = curl_init();

curl_setopt_array($curl, array(
  CURLOPT_URL => "https://ca1.qualtrics.com/API/v3/surveys/SV_doN3AIQ0sPGWuVv/export-responses/ES_8v44fkufBMUyN3T",
  CURLOPT_RETURNTRANSFER => true,
  CURLOPT_ENCODING => "",
  CURLOPT_MAXREDIRS => 10,
  CURLOPT_TIMEOUT => 0,
  CURLOPT_FOLLOWLOCATION => true,
  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
  CURLOPT_CUSTOMREQUEST => "GET",
  CURLOPT_HTTPHEADER => array(
    "X-API-TOKEN: uox0HEkJTPaXBue4R8R4BBQTjn4PmuUIcACDjbJV",
    "Content-Type: application/json"
  ),
));

$response = curl_exec($curl);

curl_close($curl);
echo $response;


}

function shc_migrate_change_club_get_qualtricsfile(){

$curl = curl_init();

curl_setopt_array($curl, array(
  CURLOPT_URL => "https://ca1.qualtrics.com/API/v3/surveys/SV_doN3AIQ0sPGWuVv/export-responses/0e65f0f7-ce0c-4105-b3b1-c4e7ac0c91e7/file",
  CURLOPT_RETURNTRANSFER => true,
  CURLOPT_ENCODING => "",
  CURLOPT_MAXREDIRS => 10,
  CURLOPT_TIMEOUT => 0,
  CURLOPT_FOLLOWLOCATION => true,
  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
  CURLOPT_CUSTOMREQUEST => "GET",
  CURLOPT_HTTPHEADER => array(
    "X-API-TOKEN: uox0HEkJTPaXBue4R8R4BBQTjn4PmuUIcACDjbJV",
    "Content-Type: application/json"
  ),
));

$response = curl_exec($curl);

curl_close($curl);
echo $response;



}
